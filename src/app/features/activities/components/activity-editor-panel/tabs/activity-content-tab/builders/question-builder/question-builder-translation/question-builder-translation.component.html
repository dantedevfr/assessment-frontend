<div *ngIf="showTranslation" class="space-y-4">
    <label class="block text-sm font-medium mb-1">Traducción</label>
    <textarea
      pTextarea
      rows="3"
      [ngModel]="translationText"
      (ngModelChange)="onTranslationChange($event)"
      class="w-full"
    ></textarea>
  
    <div class="flex justify-end">
      <p-button 
        label="Traducir palabra por palabra" 
        icon="pi pi-book" 
        (click)="onOpenWordTranslation()" 
        size="small"
        styleClass="p-button-text p-button-sm text-blue-600"
      />
    </div>
  
    <!-- Modal -->
    <p-dialog
      [(visible)]="showWordModal"
      [modal]="true"
      [draggable]="false"
      [resizable]="false"
      [style]="{ width: '700px', height: '80vh' }"
      [contentStyle]="{ 'overflow-y': 'auto' }"
      [closable]="false"
    >
      <ng-template pTemplate="header">
        <div class="flex justify-between items-center">
          <h2 class="text-lg font-semibold">Traducción palabra por palabra</h2>
        </div>
      </ng-template>
  
      <div class="space-y-4 p-2">
        <div *ngIf="textHasChanged" class="flex items-center justify-between bg-yellow-100 rounded p-3 mb-4">
            <span class="text-yellow-800 font-medium">
              El texto ha cambiado. Puedes regenerar las palabras si lo deseas.
            </span>
            <p-button
              label="Regenerar palabras"
              icon="pi pi-refresh"
              (click)="onRegenerateWords()"
              severity="warn"
              size="small"
            />
          </div>

           <!-- 🚨 No hay palabras para traducir -->
      <div *ngIf="tempWordBreakdown.length === 0" class="text-center text-gray-600 p-4">
        No hay palabras para traducir.
      </div>
  
        <p-accordion [multiple]="true">
          <ng-container *ngFor="let word of tempWordBreakdown; let i = index">
            <p-accordion-panel [value]="i">
              <p-accordion-header>
                <ng-template #toggleicon let-active="active">
                  <i [class.pi]="true" [class.pi-minus]="active" [class.pi-plus]="!active"></i>
                </ng-template>
                <span class="flex items-center gap-2">
                  <span class="font-semibold capitalize">{{ word.text }}</span>
                </span>
              </p-accordion-header>
  
              <p-accordion-content>
                <div class="space-y-3">
                  <input
                    pInputText
                    [(ngModel)]="word.translations[0].translatedText"
                    placeholder="Traducción"
                    class="w-full"
                  />
  
                  <textarea
                    pTextarea
                    [(ngModel)]="word.translations[0].explanation"
                    rows="2"
                    placeholder="Explicación (opcional)"
                    class="w-full"
                  ></textarea>
  
                  <!-- 📤 Upload de archivo -->
    <p-fileupload
      #fileUploader
      name="demo[]"
      url="https://www.primefaces.org/cdn/api/upload.php"
      (onSelect)="onSelectWordMedia($event, word)"
      (onClear)="onClearUpload()"
      (onRemove)="onClearUpload()"
      [accept]="'image/*,audio/*,video/*'"
      [multiple]="false"
      maxFileSize="1000000"
      mode="advanced"
    >
      <ng-template #empty>
        <div>Arrastra los archivos aquí para subirlos.</div>
      </ng-template>
      <ng-template #content>
        <ul *ngIf="uploadedWordFiles.length > 0">
            <li *ngFor="let file of uploadedWordFiles">
              {{ file.name }} - {{ file.size }} bytes
            </li>
          </ul>
      </ng-template>
    </p-fileupload>
                </div>
              </p-accordion-content>
            </p-accordion-panel>
          </ng-container>
        </p-accordion>
  
      </div>
  
      <ng-template pTemplate="footer">
        <div class="flex justify-end gap-2">
          <p-button label="Cancelar" (click)="onCancelWordTranslation()" severity="secondary" />
          <p-button label="Guardar" (click)="onSaveWordTranslation()" severity="primary" />
        </div>
      </ng-template>
    </p-dialog>
  </div>
  